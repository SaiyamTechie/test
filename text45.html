<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Voice Assistant</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        input, button, select { font-size: 18px; padding: 10px; margin: 10px; width: 80%; }
        #response { margin-top: 20px; font-size: 20px; }
    </style>
</head>
<body>

    <h2>Ask AI & Hear the Answer</h2>
    <input id="question" type="text" placeholder="Enter your question..." />
    <button onclick="askAI()">Ask</button>

    <label for="voiceSelect">Choose Voice:</label>
    <select id="voiceSelect">
        <option value="en|1">English (Male)</option>
        <option value="en|0.9">English (Female)</option>
        <option value="en-GB|1">English UK (Male)</option>
        <option value="hi|1">Hindi (Male)</option>
        <option value="hi|0.9">Hindi (Female)</option>
        <option value="es|1">Spanish (Male)</option>
        <option value="es|0.9">Spanish (Female)</option>
    </select>

    <p id="response"></p>
    <audio id="audioPlayer" controls></audio>

    <script>
        const GEMINI_API_KEY = "AIzaSyAVedCyJvBBIEqGEgno32tP3lbRjtFQODw"; // Replace with your API key
        const GOOGLE_TTS_URL = "https://translate.google.com/translate_tts?ie=UTF-8&client=tw-ob&q=";
        const CHUNK_SIZE = 200; // Max characters per TTS request

        async function askAI() {
            const question = document.getElementById("question").value;
            if (!question) return alert("Please enter a question!");

            document.getElementById("response").innerText = "Thinking...";

            try {
                const responseText = await fetchGeminiResponse(question);
                document.getElementById("response").innerText = responseText;

                // Convert text to speech and play in chunks
                playTextToSpeech(responseText);
            } catch (error) {
                document.getElementById("response").innerText = "Error getting AI response.";
                console.error("Error:", error);
            }
        }

        async function fetchGeminiResponse(question) {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ contents: [{ parts: [{ text: question }] }] })
            });

            const data = await response.json();
            if (!data.candidates || !data.candidates.length) throw new Error("No response from AI.");
            return data.candidates[0].content.parts[0].text;
        }

        function splitTextIntoChunks(text, chunkSize) {
            let chunks = [];
            for (let i = 0; i < text.length; i += chunkSize) {
                chunks.push(text.substring(i, i + chunkSize));
            }
            return chunks;
        }

        function playTextToSpeech(text) {
            const voiceSelect = document.getElementById("voiceSelect").value.split("|");
            const lang = voiceSelect[0];  // Language code
            const speed = voiceSelect[1]; // Speed (affects voice tone)

            const chunks = splitTextIntoChunks(text, CHUNK_SIZE);
            let index = 0;
            const audioPlayer = document.getElementById("audioPlayer");

            function playNextChunk() {
                if (index < chunks.length) {
                    const ttsUrl = `${GOOGLE_TTS_URL}${encodeURIComponent(chunks[index])}&tl=${lang}&ttsspeed=${speed}`;
                    audioPlayer.src = ttsUrl;
                    audioPlayer.play();
                    index++;
                    audioPlayer.onended = playNextChunk;
                }
            }

            playNextChunk();
        }
    </script>

</body>
</html>